+++
title = "Leading rock researchers rely on Coreform Cubit to decipher ancient magnetic recordings"
keywords = "coreform cubit, academic meshing software, engineering education, geothermal, MOOSE"
description = "Cutting-edge rock magnetism studies require quality meshes that can be exported to an in-house solver. Coreform Cubit was selected for the job."
type = "case-studies"
featured_image = "featured.png"
date = "2023-10-17"
summary="The rock-magnetism group at the School of GeoSciences at the University of Edinburgh is performing groundbreaking research to better understand earth’s past through ancient magnetic recordings, and Coreform Cubit is an important part of their work due to the demanding mesh quality requirements for simulation of natural magnetic particles."
+++

{{% section %}}

<!--{{% figure src="images/caltechlogo.png" width="200" class="floatright" caption="" %}}<br> -->

 
<!-- <blockquote class="pullquote" style="width: 350px; font: bold 1.333em/1.125em &quot;Open Sans&quot;, sans-serif; margin: 2.5em 2.5em 2.5em 2.5em !important; padding: 0.6em 5px !important; background: none !important; border: 3px double \#ddd; border-width: 3px 0; text-align: center; float: left; ">---<br>Once you use Coreform Cubit for scripting automated mesh generation, you will never go back.<br>&mdash; Dr. Klaus Roppert<br>---</blockquote> -->



##### Background  
The rock-magnetism group at the School of GeoSciences at the University of Edinburgh is performing groundbreaking research to better understand earth’s past through ancient magnetic recordings, and Coreform Cubit is an important part of their work due to the demanding mesh quality requirements for simulation of natural magnetic particles. 

{{% figure src="student.jpeg" width="400" class="floatright" caption="PhD student from the University of <br>Edinburgh drills a rock sample that contains<br> the magnetic materials and records of the<br> magnetic field from when Mt. Vesuvius erupted." %}}<br>

Magnetic fields play a critical role in the birth and evolution of planets. On planet Earth, the geomagnetic field is generated by vigorous convection of its liquid iron outer core, 3000 km below the surface. The changing shape and intensity of the geomagnetic field reveals much about the evolving thermal and chemical conditions deep in the Earth’s core, as well as the motion of the continents on Earth’s surface. By “playing back" these natural ancient magnetic recordings, researchers can better understand the physical and chemical environment at each point in time in the history of the solar system, as well as deep within planetary bodies. By “playing back" these natural ancient magnetic recordings, researchers can better understand the physical and chemical environment at each point in time in the history of the solar system, as well as deep within planetary bodies. This paleomagnetic information not only helps us to understand the evolution of our own planet and solar system, but also that of other systems in our galaxy and beyond.  


<aside class="pquote">
	<p>Creating computational analogues of rock samples containing millions of magnetic particles requires a meshing tool capable of generating high quality meshes in irregular structures. The reliability and speed of Coreform Cubit, combined with its extensive scripting capabilities, creates an efficient workflow that is practically unrivaled.<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &mdash; Wyn Williams, Professor of Mineral Magnetism, University of Edinburgh</p>
</aside>



##### Problem
Geothermal reservoirs provide a potentially cheap and efficient form of completely clean and renewable energy. Unfortunately, the initial costs of accessing a suitable location and building infrastructure to transform and transfer the generated energy are high. Understanding the behavior of multicomponent (fractured) porous rock-fluid systems and their multiphysics dynamics is essential for making accurate predictions about how subsurface reservoirs will behave. This matters whether they are being used to harvest geothermal energy and fossil fuels, to store carbon dioxide, or as nuclear waste disposals. In such studies, the physical process that controls the geomaterial behavior is complex and nonlinear. Such simulations must capture the effects of thermo-elastic responses of geomaterials located near the injection fractures, which are affected by the cooling-off effect resulting from injection of cold fluid into a hot reservoir. 

The investigations of the Edinburgh group into natural magnetic recordings require **high-quality meshes in a format compatible with their in-house tool**. At the same time, they are not meshing experts, so their meshing tool must be **accessible to new users** and **priced affordably for academic researchers**. 

High quality meshes are vital for simulation because terrestrial rocks and meteorites have a varied and complex mineralogy. Unlike the “ideal” magnetic recording media contained in computer hard drives and other man-made recording media, the magnetic signal in rocks is often carried by more than one type of mineral, and in a variety of grain sizes and shapes. Almost always, the magnetization within these particles is non-uniform, and their magnetic recording fidelity can only be determined through computational models.

The right meshing tool for this task would need to be able to **handle a variety of geometries and materials**, and also **be scriptable**, as each study can include thousands of particles. The unique physics involved in rock magnetics requires a specialized solver to be best understood. The rock-magnetic group at the School of GeoSciences at the University of Edinburgh, in collaboration with The Norwegian University of Science and Technology (NTNU) Norway, University of Liverpool, and Imperial College London, developed a finite-element solver for micromagnetics, called MERRILL (www.rockmag.org). MERRILL is maintained as an open-source code micromagnetic solver for earth scientists and is suited for the investigation into magnetic recordings. While this solver was uniquely written to solve specific problems, the solver developers sought for an off-the-shelf meshing software that could prepare the computation meshes required by this niche code.




##### Solution

The team at the University of Edinburgh selected Coreform Cubit as their tool of choice to create the meshes for their simulations with their open-source solver. Coreform Cubit works across multiple platforms and has built-in mesh quality metrics. It allows users to easily identify defects in the original geometry, such as non-closed surfaces or poor quality meshes associated with geometry irregularities. Coreform Cubit is also 100% scriptable with Python and its own commands, so experts can use it to automate their work. Before deciding on Coreform Cubit, the team tried an  open-source tool, but it was not flexible or efficient enough for the work they are doing.

An example of Coreform Cubit’s value is demonstrated in the creation of the high quality finite-element meshes from the 3-dimensional particle geometries shown in Figure 1. These geometries are created with a resolution of just a few nanometers by using Edinburgh’s technique of  “slice-and-view.” In this method, a focused ion beam (FIB) is used to mill out a 3 nm thick layer of a rock sample, which is then treated with energy-dispersive X-ray spectroscopy to reveal its elemental and chemical composition. Successive slices are stitched together with FIJI ImageJ image processing software to create a full 3-dimensional visual reconstruction of the magnetic grain distribution (See Figure 1). This reconstruction provides a unique meshing challenge, due the the large number of grains and their complex geometries.

{{% figure src="particles.png" width="800" class="floatright" caption="Focused ion beam slice-and-view reconstruction of magnetite particles within basalt from the 1944 Vesuvius eruption, with a grain size distribution on the right. The median grain size is 136nm from 175 particles measured, with a resolution of 3 nm. The grain distribution is highly varied and irregular, and requires an efficient and user-friendly tool to mesh the grains appropriately."%}}<br>

“Coreform Cubit has an extremely useful option that allows users to perform ‘geometry tolerant’ meshing that ignores small surface defects. This allows for the retention of as much of the fine detail of the grain shape geometry as possible while producing a good quality mesh,” said Dr. Williams.

Coreform Cubit also enables easy partitioning and visualization of the geometry into any number of different regions, which can be associated with variations of materials in the magnetic mineralogy.  

The rock-magnetism group’s models typically require millions of tetrahedral elements, and the Coreform Cubit parallel tet meshing capabilities greatly speed up this workflow. Figure 2 shows the particle reconstruction from one of the magnetite grains shown in Figure 1. This particle was meshed with linear tetrahedral elements constrained to an element size of 8 nm. Typically, a single rock study will require many thousands of particles to be meshed, and Cubit’s APREPRO scripting language provides an easy way to automate the meshing process.   

{{% figure src="meshed.particle.png" width="500" class="floatright" caption="A typical mesh, generated in Coreform Cubit, of a ~200nm magnetite particle, selected from the particles distribution shown in Fig 1. The grain is filled with linear tetrahedral elements, constrained at 8 nm average size." %}}<br>

As the rock-magnetism team are not meshing experts, they found Coreform’s [forum](https://forum.coreform.com) community particularly helpful in navigating meshing issues with their complex natural geometries. Coreform Cubit has become the de–facto recommended mesher for the open-source MERRILL community, and has been used to generate their [work for publication](https://doi.org/10.1029/2022GL102602).

After the geometry is meshed in Coreform Cubit, it is exported to the PATRAN format that is required by the micromagnetic modeling software MERRILL. MERRILL then computes the magnetic domain structure, as well as the magnetic thermal stability. There are several magnetic structures possible in any one geometry, but a typical solution is shown in Figure 3. 

{{% figure src="results.png" width="500" class="floatleft" caption="Useful results are obtained by MERRILL with high quality mesh inputs from Coreform Cubit. The local minimum energy magnetic structure is shown here;  The magnetic direction in the particle is indicated by the arrows, colored to show alignment to ‘easy’ and ‘hard’ magnetic anisotropy direction. Also drawn are helicity isosurfaces in yellow and purple that highlight the vortex nature of the dominant magnetic structure. This information helps the rock-magnetic team learn more about natural magnetic recordings than the world has known before." %}}

The visualization shows the variation in magnetic direction throughout the grain, and highlights regions which are aligned with “easy” and “hard” magnetic anisotropy directions.  Also characteristic of natural materials is the dominance of magnetic vortex structures, highlighted by the isosurfaces shown in Figure 3. The structures were first observed by researchers almost 30 years ago, but it is only through recent micromagnetic computational analysis using Coreform Cubit and MERRILL that researchers can carefully reconstruct the recording properties of natural materials and accurately replay their magnetic memories.



<!-- {{% figure src="" width="" class="floatleft" caption=""   %}} -->

##### Conclusion

Through using Coreform Cubit for advanced meshing for their challenging simulations to generate the meshes for their open-source solver, the rock-magnetic group at the University of Edinburgh is able to efficiently conduct cutting-edge paleomagnetic research to better understand the geological evolution of Earth and other planets. 


{{% /section %}}


---  

### Coreform Cubit information

Visit the [product overview page](/products/coreform-cubit/) to learn more about Coreform Cubit. 

Sign up for a [free trial](/products/trial/) of Coreform Cubit. 

[Coreform Cubit Learn](../../free-meshing-software/) is a free limited license available for non-commercial student use.

[Contact Coreform](/company/contact) for more details: sales@coreform.com

<br>

---

